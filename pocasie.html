<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aktuálne počasie</title>
    <link rel="stylesheet" href="styles/pocasie.css">
    <script>
        const apiKey = 'fe04a97a6d4495c64b721cedb16596c2'; // Váš API kľúč

        async function fetchWeatherByCityId(cityId, elementId) {
            const url = `https://api.openweathermap.org/data/2.5/weather?id=${cityId}&units=metric&lang=sk&appid=${apiKey}`;
            try {
                const response = await fetch(url);
                const data = await response.json();
                const temperature = data.main.temp; // Získanie teploty
                document.getElementById(elementId).textContent = `${temperature} °C`;
            } catch (error) {
                console.error(`Chyba pri načítaní údajov pre mesto ID (${cityId}):`, error);
                document.getElementById(elementId).textContent = "Chyba načítania";
            }
        }

        async function fetchAirQuality(lat, lon, elementId) {
            const url = `https://api.openweathermap.org/data/2.5/air_pollution?lat=${lat}&lon=${lon}&appid=${apiKey}`;
            try {
                const response = await fetch(url);
                const data = await response.json();
                const pm25 = data.list[0].components.pm2_5; // Získanie PM2.5
                document.getElementById(elementId).textContent = `${pm25.toFixed(1)} µg/m³`;
            } catch (error) {
                console.error(`Chyba pri načítaní údajov o kvalite ovzdušia (${lat}, ${lon}):`, error);
                document.getElementById(elementId).textContent = "Chyba načítania";
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            // Načítanie údajov pre jednotlivé mestá
            fetchWeatherByCityId(865084, 'temperature-kosice'); // Košice
            fetchAirQuality(48.7164, 21.2611, 'pm25-kosice'); // Košice

            fetchWeatherByCityId(865085, 'temperature-presov'); // Prešov
            fetchAirQuality(48.9985, 21.2339, 'pm25-presov'); // Prešov

            fetchWeatherByCityId(723846, 'temperature-batizovce'); // Batizovce
            fetchAirQuality(49.0665, 20.2195, 'pm25-batizovce'); // Batizovce
        });
    </script>
</head>
<body class="map-page">
    <header class="map-page">
        <h1 class="header-title">SO Air Quality Sprint App</h1>
        <nav class="navbar map-page">
            <a href="index.html" class="nav-link">Úvod</a>
            <a href="pocasie.html" class="nav-link active">Počasie</a>
            <a href="mapa.html" class="nav-link">Mapa</a>
            <a href="profil.html" class="nav-link">Profil</a>
            <a href="login.html" class="nav-link login-button">Login</a>
        </nav>
    </header>

    <main>
        <div class="header">Aktuálne počasie</div>

        <div class="content-wrapper">
            <div class="city-container">
                <div class="city-card" data-city="Kosice">
                    <img src="images/kosice.jpg" alt="Košice">
                    <div class="city-name">KOŠICE</div>
                    <div class="city-info">TEPLOTA: <span id="temperature-kosice" class="highlight-temperature">Nahráva sa...</span><br>PRIEMERNÁ PM2.5: <span id="pm25-kosice" class="highlight-temperature">Nahráva sa...</span></div>
                    <a href="mapa_kosice.html" class="detail-button">DETAILNÁ MAPA</a>

                    <div class="iframe-container">
                        <iframe src="https://api.wo-cloud.com/content/widget/?geoObjectKey=1397050&language=en&region=GB&timeFormat=HH:mm&windUnit=kmh&systemOfMeasurement=metric&temperatureUnit=celsius" name="CW2" scrolling="no" width="170" height="192" frameborder="0" style="border-radius: 8px"></iframe>
                    </div>
                </div>

                <div class="city-card" data-city="Presov">
                    <img src="images/presov.jpg" alt="Prešov">
                    <div class="city-name">PREŠOV</div>
                    <div class="city-info">TEPLOTA: <span id="temperature-presov" class="highlight-temperature">Nahráva sa...</span><br>PRIEMERNÁ PM2.5: <span id="pm25-presov" class="highlight-temperature">Nahráva sa...</span></div>
                    <a href="mapa_presov.html" class="detail-button">DETAILNÁ MAPA</a>

                    <div class="iframe-container">
                        <iframe src="https://api.wo-cloud.com/content/widget/?geoObjectKey=15994426&language=en&region=GB&timeFormat=HH:mm&windUnit=kmh&systemOfMeasurement=metric&temperatureUnit=celsius" name="CW2" scrolling="no" width="170" height="192" frameborder="0" style="border-radius: 8px"></iframe>
                    </div>
                </div>

                <div class="city-card" data-city="Batizovce">
                    <img src="images/batizovce.jpg" alt="Batizovce">
                    <div class="city-name">BATIZOVCE</div>
                    <div class="city-info">TEPLOTA: <span id="temperature-batizovce" class="highlight-temperature">Nahráva sa...</span><br>PRIEMERNÁ PM2.5: <span id="pm25-batizovce" class="highlight-temperature">Nahráva sa...</span></div>
                    <a href="mapa_batizovce.html" class="detail-button">DETAILNÁ MAPA</a>

                    <div class="iframe-container">
                        <iframe src="https://api.wo-cloud.com/content/widget/?geoObjectKey=11673804&language=en&region=GB&timeFormat=HH:mm&windUnit=kmh&systemOfMeasurement=metric&temperatureUnit=celsius" name="CW2" scrolling="no" width="170" height="192" frameborder="0" style="border-radius: 8px"></iframe>
                    </div>
                </div>
            </div>

            <div class="map-container">
                <iframe
                    src="https://embed.windy.com/embed2.html?lat=48.673753&lon=19.696059&detailLat=48.673753&detailLon=19.696059&zoom=7&level=surface&overlay=temperature&product=ecmwf&menu=&message=true&marker=false&calendar=now&pressure=true&type=map&location=coordinates&metricWind=km%2Fh&metricTemp=%C2%B0C&radarRange=-1"
                    frameborder="0"
                    style="border: none; border-radius: 8px;">
                </iframe>
            </div>
        </div>
    </main>
    <footer class="footer">
        <p>&copy; 2024 SO Air Quality Sprint App. Všetky práva vyhradené.</p>
    </footer>
</body>
</html>
